ai:
  model: anthropic/claude-sonnet-4-20250514

agents:
  explore:
    model: "opencode/gpt-5-nano"

pre-commit:
  parallel: false  # fmt must run first to auto-fix before clippy checks
  commands:
    - name: fmt
      # Auto-format staged .rs files and re-stage them
      run: |
        staged=$(git diff --cached --name-only --diff-filter=ACM | grep '\.rs$' || true)
        [ -z "$staged" ] && exit 0
        echo "$staged" | xargs cargo fmt --
        echo "$staged" | xargs git add
    - name: clippy
      run: cargo clippy -- -D warnings
    - name: typos
      run: ./target/debug/astrape typos --ai --stage

post-commit:
  parallel: false
  commands:
    - name: auto-push
      run: git push origin HEAD
